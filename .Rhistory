test2 <- test[,"count"]
test <- mtx[max_target,]
number <- 1:ncol(mtx)
test <- cbind(number, test)
colnames(test) <- c("number","count")
test
rownames(test) <- NULL
test
test2 <- test[,"count"]
test2
test <- mtx[max_target,]
test
lab <- rep("", length(test2))
test2 <- mtx[max_target,]
lab <- rep("", length(test2))
test2
lab[seq(1, length(test2), by=1000)] <-names(test2)[seq(1, length(test2), by=1000)]
test2
lab
test <- mtx[max_target,]
test2 <- mtx[max_target,]
lab <- rep("", length(test2))
lab[seq(1, length(test2), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
lab
length(test2)
test
names(test)
names(test)[seq(1, length(test), by=1000)]
names(test2)[seq(1, length(test2), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
test2
lab <- rep("", length(test2))
names(test2)[seq(1, length(test2), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
test2
lab <- rep("", length(test2))
test2
test
lab <- rep("", length(test2))
lab
lab[seq(1, length(test2), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
lab
test <- mtx[max_target,]
test2 <- mtx[max_target,]
lab <- rep("", length(test2))
lab[seq(1, length(test2), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
lab
test <- mtx[max_target,]
test2 <- mtx[max_target,]
test
lab
lab <- rep(NA, length(test))
test
lab
lab[seq(1, length(test), by=5)] <-names(test)[seq(1, length(test), by=5)]
lab
lab <- rep(NA, length(test))
lab[seq(1, length(test), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
lab
lab <- rep(NA, length(test))
lab[seq(1, length(test), by=100)] <-names(test)[seq(1, length(test), by=100)]
lab
lab <- rep(NA, length(test))
lab[seq(1, length(test), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
barplot(test, names.arg=lab)
test <- mtx[max_target,]
number <- 1:ncol(mtx)
test <- cbind(number, test)
colnames(test) <- c("number","count")
rownames(test) <- NULL
test
as.character(test$number)
test <- mtx[max_target,]
test <- mtx[max_target,]
rownames(test) <- 1:length(mtx)
test <- mtx[max_target,]
number <- 1:ncol(mtx)
test <- cbind(number, test)
colnames(test) <- c("number","count")
rownames(test) <- NULL
test
test <- test[,count]
test <- test[,"count"]
test
lab <- rep(NA, length(test))
lab[seq(1, length(test), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
lab
length(test)
lab
lab <- rep(NA, length(test))
lab[seq(1, length(test), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
lab <- rep("", length(test))
test
lab
lab[seq(1, length(test), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
test <- mtx[max_target,]
test
lab <- rep("", length(test))
lab[seq(1, length(test), by=10000)] <-names(test)[seq(1, length(test), by=10000)]
lab
barplot(test, names.arg=lab)
test <- mtx[max_target,]
barplot(test)
names(test) <- 1:length(test)
test
barplot(test)
barplot(test,las=2)
lab <- rep("", length(test))
lab[seq(1, length(test), by=10000)] <-names(test)[seq(1, length(test), by=10000)]
barplot(test, names.arg=lab, lab=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab
test
lab[seq(1, length(test), by=10000)] <-names(test)[seq(1, length(test), by=10000)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=1000)] <-names(test)[seq(1, length(test), by=1000)]
barplot(test, names.arg=lab, las=2)
lab
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=10)] <-names(test)[seq(1, length(test), by=10)]
lab
test
lab
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=5)] <-names(test)[seq(1, length(test), by=5)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(0, length(test), by=10)] <-names(test)[seq(0, length(test), by=10)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(0, length(test), by=100)] <-names(test)[seq(0, length(test), by=100)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(0, length(test), by=10)] <-names(test)[seq(0, length(test), by=10)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(10, length(test), by=10)] <-names(test)[seq(10, length(test), by=10)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=10)] <-names(test)[seq(1, length(test), by=10)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(10, length(test), by=10)] <-names(test)[seq(10, length(test), by=10)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(10, length(test), by=5)] <-names(test)[seq(10, length(test), by=5)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(10, length(test), by=2)] <-names(test)[seq(10, length(test), by=2)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=5)] <-names(test)[seq(1, length(test), by=5)]
barplot(test, names.arg=lab, las=2)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=5)] <-names(test)[seq(1, length(test), by=5)]
barplot(test, names.arg=lab, las=1)
test <- mtx[max_target,]
names(test) <- 1:length(test)
lab <- rep("", length(test))
lab[seq(1, length(test), by=5)] <-names(test)[seq(1, length(test), by=5)]
barplot(test, names.arg=lab, las=2)
barplot(test, names.arg=lab, las=2, main="The highest gRNA in all cells", sub="",
xlab=paste0(max_target, " (gRNA)"), ylab="Expression level")
test <- mtx[max_target,]
names(test) <- 1:length(test)
ggplot(data.frame(test),aes(seq_along(test),test))+geom_bar(stat="identity")
test <- mtx[max_target,]
names(test) <- 1:length(test)
#lab <- rep("", length(test))
#lab[seq(1, length(test), by=5)] <-names(test)[seq(1, length(test), by=5)]
barplot(test, names.arg=lab, las=2, main="The highest gRNA in all cells", sub="",
xlab=paste0(max_target, " (gRNA)"), ylab="Expression level")
test <- mtx[max_target,]
names(test) <- 1:length(test)
barplot(test, names.arg=lab, las=2, main=paste0("The highest gRNA (targeting", max_target, ") in all cells"),
ylab="Expression level")
test <- mtx[max_target,]
names(test) <- 1:length(test)
barplot(test, names.arg=lab, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"),
ylab="Expression level")
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
png(file="./analysis/results/gRNA_max_target.png",
width=2000, height=1500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
if (dir.exists("./analysis/cache/")==FALSE){
dir.create("./analysis/cache/")
}
png(file="./analysis/results/gRNA_max_target.png",
width=2000, height=1500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
if (dir.exists("./analysis/results/")==FALSE){
dir.create("./analysis/results/")
}
png(file="./analysis/results/gRNA_max_target.png",
width=2000, height=1500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
png(file="./analysis/export/gRNA_max_target.png",
width=1000, height=750)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
if (dir.exists("./analysis/export/")==FALSE){
dir.create("./analysis/export/")
}
png(file="./analysis/export/gRNA_max_target.png",
width=1000, height=750)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
png(file="./analysis/export/gRNA_max_target.png",
width=1200, height=800)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
png(file="./analysis/export/gRNA_max_target.png",
width=1500, height=1000)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
png(file="./analysis/export/gRNA_max_target.png",
width=1600, height=1000)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
png(file="./analysis/export/gRNA_max_target.png",
width=800, height=500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
pdf(file="./analysis/export/gRNA_max_target.pdf",
width=800, height=500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
pdf(file="./analysis/export/gRNA_max_target.pdf",
#width=800, height=500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
jpeg(file="./analysis/export/gRNA_max_target.jpeg",
#width=800, height=500)
barplot(test, names.arg=lab, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
jpeg(file="./analysis/export/gRNA_max_target.jpeg",
#width=800, height=500)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=6, height=4, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=12, height=8, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=12, height=8, units="in", res=600)
barplot(test, las=2, xlab="Cell", ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=15, height=10, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=16, height=10, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="\n Cell",
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="\n \n Cell",
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="\n \n \n Cell",
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=" \n  \n  \n Cell",
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=paste(" \n  \n  \n Cell"),
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=paste("Cell\n n=" , "Cell" , sep="")
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=paste("Cell\n n=" , "Cell" , sep=""),
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=paste("Cell\n " , "Cell\n " , "Cell\n", sep=""),
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=paste("Cell1\n " , "Cell2\n " , "Cell3\n ", "Cell4\n "sep=""),
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab=paste("Cell1\n " , "Cell2\n " , "Cell3\n ", "Cell4 \n ", sep=""),
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="Cell",
ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="Cell",
title(ylab="Expression level", line=0)
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="Cell",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(ylab="Expression level", line=0)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, xlab="Cell",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(ylab="Expression level", line=2)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=-1)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=2)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=5)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=4)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=3.5)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, ylab="Expression level",
main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=3.8)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=3.7)
title(ylab="Expression level", line=3)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=3.7)
title(ylab="Expression level", line=3.7)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=3.7)
title(ylab="Expression level", line=3.2)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Cell", line=3.7)
title(ylab="Expression level", line=3.1)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Barcode (Cell)", line=3.7)
title(ylab="UMI count (Expression level)", line=3.1)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Barcode (Cell)", line=3.7)
title(ylab="UMI count", line=3.1)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff",
width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Barcode/Cell", line=3.7)
title(ylab="UMI counts", line=3.1)
dev.off()
tiff(file="./analysis/export/gRNA_max_target.tiff", width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Barcode (Cell)", line=3.7)
title(ylab="UMI counts", line=3.1)
dev.off()
target_means <- read.csv("./analysis/cache/gRNA_matrix_targets_summary.csv",
header = TRUE, na.strings=c("","NA"))
max_target <- target_means[which.max(target_means$target_mean), "target_name"]
med_target <- target_means[which.median(target_means$target_mean), "target_name"]
min_target <- target_means[which.min(target_means$target_mean), "target_name"]
med_target <- target_means[whichmedian(target_means$target_mean), "target_name"]
med_target <- target_means[median(target_means$target_mean), "target_name"]
test <- mtx[med_target,]
names(test) <- 1:length(test)
tiff(file="./analysis/export/gRNA_max_target.tiff", width=8, height=5, units="in", res=600)
barplot(test, las=2, main=paste0("The highest gRNA (targeting ", max_target, ") in all cells"))
title(xlab="Barcode (Cell)", line=3.7)
title(ylab="UMI counts", line=3.1)
dev.off()
median(target_means$target_mean)
which.max(target_means$target_mean)
filename <- paste0("./analysis/cache/", mtx, "_matrix_targets_summary.csv")
filename
mtx <- "gRNA"
filename <- paste0("./analysis/cache/", mtx, "_matrix_targets_summary.csv")
filename
target_means <- read.csv(filename, header = TRUE)
max_target <- target_means[which.max(target_means$target_mean), "target_name"]
min_target <- target_means[which.min(target_means$target_mean), "target_name"]
View(target_means)
filename <- paste0("./analysis/export", mtx, "_max_target.tif")
filename
filename <- paste0("./analysis/export/", mtx, "_max_target.tif")
filename
# workflowR publish
wflow_publish("./analysis/*.Rmd")
