getwd
getwd()
wflow_build()
library("workflowr")
wflow_build()
wflow_git_config(user.name = "Hang Chen", user.email = "chen_h@outlook.com")
wflow_start("myproject")
rmarkdown::find_pandoc()
# load
setwd("./rotation2/")
library(workflowr)
whichmodel <- read.csv("./analysis/cache/Expression_filtered_means_non-zeros.csv", header = TRUE)
whichmodel <- dplyr::mutate(whichmodel, zero_prop = 1 - target_non_zero_count / ncol(Expression@assays$RNA@counts) )
whichmodel_10 <- dplyr::filter(whichmodel, target_mean <= 10)
library(Seurat)
library(dplyr)
library(ggplot2)
library(ggeasy)
whichmodel <- read.csv("./analysis/cache/Expression_filtered_means_non-zeros.csv", header = TRUE)
whichmodel <- dplyr::mutate(whichmodel, zero_prop = 1 - target_non_zero_count / ncol(Expression@assays$RNA@counts) )
whichmodel_10 <- dplyr::filter(whichmodel, target_mean <= 10)
library(Seurat)
library(dplyr)
library(ggplot2)
library(ggeasy)
Expression <- readRDS("../Morris_2021/filter/Expression.rds", refhook = NULL)
library(Seurat)
library(dplyr)
library(ggplot2)
library(ggeasy)
Expression <- readRDS("../Morris_2021/filter/Expression.rds", refhook = NULL)
whichmodel <- read.csv("./analysis/cache/Expression_filtered_means_non-zeros.csv", header = TRUE)
whichmodel <- dplyr::mutate(whichmodel, zero_prop = 1 - target_non_zero_count / ncol(Expression@assays$RNA@counts) )
whichmodel_10 <- dplyr::filter(whichmodel, target_mean <= 10)
mean(Expression@assays$RNA@counts)
sum(Expression@assays$RNA@counts)
nrow(Expression@assays$RNA@counts
)
ncol(Expression@assays$RNA@counts)
sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))
plot(x=0:10, dpois(x=0:10), lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts)) )
lam <- plot(x=0:10, dpois(x=0:10), lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts)) )
plot(x=0:10, dpois(x=0:10), lambda =  alm)
lam <- plot(x=0:10, dpois(x=0:10), lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts)) )
plot(x=0:10, dpois(x=0:10, lambda =  lam))
lam <- plot(x=0:10, dpois(x=0:10), lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts)) )
plot(x=0:10, dpois(x=0:10, lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))) )
plot(x=0:10, dpois(x=0:10, lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))) )
plot(x=seq(0, 10, by = 0.1), dpois(x=seq(0, 10, by = 0.1),
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))) )
plot(x=seq(0, 10, by = 0.5), dpois(x=seq(0, 10, by = 0.5),
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))) )
plot(seq(0, 10, by = 0.5), dpois(x=seq(0, 10, by = 0.5),
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))) )
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts)))
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))
expected_poisson <- dpois(x=seq(0, 10, by = 0.5), lambda =  lambda)
expected_poisson <- dpois(x=1:10, lambda =  lambda)
expected_poisson <- dpois(x=0.1, lambda =  lambda)
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))
expected_poisson <- dpois(x=1:10, lambda =  lambda)
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))
expected_poisson <- dpois(x=1:10, lambda =  lambda)
expected_poisson = c(1:10)
expected_poisson <- data.frame(expected_poisson ,dpois(x=1:10, lambda =  lambda))
View(expected_poisson)
expected_poisson <- data.frame(c(1:10), dpois(x=1:10, lambda =  lambda))
lambda = sum(Expression@assays$RNA@counts) / (nrow(Expression@assays$RNA@counts) * ncol(Expression@assays$RNA@counts))
expected_poisson <- data.frame(c(1:10), dpois(x=1:10, lambda =  lambda))
colnames(expected_poisson) <- c("x", "y")
View(expected_poisson)
ggplot(data=expected_poisson, aes(x=x, y=y)) +
geom_smooth(method="glm", method.args=list(family="poisson"))
View(expected_poisson)
ggplot(data=expected_poisson, aes(x=x, y=y)) +
geom_line(data = expected_poisson, aes(x = x, y = y))
ggplot(data=expected_poisson) +
geom_line(data = expected_poisson, aes(x = x, y = y))
ggplot(data=expected_poisson) +
geom_line(data = spline_int, aes(x = x, y = y))
ggplot(data=expected_poisson) +
stat_smooth(aes(x = x, y = y), method = "glm", formula = y ~ x, se = FALSE)
ggplot(data=expected_poisson) +
stat_smooth(aes(x = x, y = y), method = "glm", method.args=list(family="poisson"))
ggplot(data=expected_poisson) +
stat_smooth(aes(x = x, y = y), method = "glm", method.args=list(family="poisson"), formula = y ~ x)
ggplot(expected_poisson) +
geom_point(aes(x = x, y = y, colour = cvr), size = 3) +
stat_smooth(aes(x = hour, y = impressions), method = "lm",
formula = y ~ poly(x, 21), se = FALSE) +
coord_cartesian(ylim = c(0, 1.5e7))
ggplot(expected_poisson) +
geom_point(aes(x = x, y = y), size = 3) +
stat_smooth(aes(x = x, y = y), method = "lm",
formula = y ~ poly(x, 21), se = FALSE) +
coord_cartesian(ylim = c(0, 1.5e7))
ggplot(expected_poisson) +
geom_point(aes(x = x, y = y), size = 3) +
stat_smooth(aes(x = x, y = y), method = "lm",
formula = y ~ poly(x, 21), se = FALSE) +
coord_cartesian(ylim = c(0, 1))
ggplot(expected_poisson) +
geom_point(aes(x = x, y = y), size = 3) +
stat_smooth(aes(x = x, y = y), method = "lm",
formula = y ~ poly(x, 21), se = FALSE) +
coord_cartesian(ylim = c(0, 1))
ggplot(expected_poisson) +
geom_point(aes(x = x, y = y), size = 3) +
stat_smooth(aes(x = x, y = y), method = "glm",
formula = y ~ x, se = FALSE) +
coord_cartesian(ylim = c(0, 1))
# plot
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
geom_line(data = spline.d, aes(x = x, y = y)) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title() +
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title() +
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
geom_line(data = spline.d, aes(x = x, y = y)) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
dev.off()
3!
prod(1:3)
prod(1:4)
X <- 1:10
Y <- dpois(X, lambda)
Y <- data.frame(X ,dpois(X, lambda))
View(Y)
Y <- data.frame(1:10 ,dpois(X, lambda))
pois_exp <- data.frame(1:10 ,dpois(X, lambda))
pois_exp <- data.frame(1:10 ,dpois(X, lambda))
colnames(pois_exp) <- c("X","Y")
View(pois_exp)
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X, color=cvr))
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X)
)
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X) +
stat_smooth(aes(y=Y, x=X), method = lm, formula = y ~ poly(x, 10), se = FALSE)
)
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 10), se = FALSE)
)
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X))
+
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 10), se = FALSE)
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X)) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 10), se = FALSE)
ggplot(pois_exp) +
geom_line(aes(y=Y, x=X)) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 3), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 2), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.5), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
#geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title() +
stat_smooth(data=pois_exp, aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
dev.off()
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(0, 9.9), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(0.1, 9.9), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
ggplot(pois_exp) +
stat_smooth(aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
#geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title() +
geom_line() +
stat_smooth(data=pois_exp, aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
#geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title() +
stat_smooth(data=pois_exp, aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
dev.off()
# plot
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title() +
#stat_smooth(data=pois_exp, aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
#stat_smooth(data=pois_exp, aes(y=Y, x=X), method = "lm", formula = y ~ poly(x, 9.9), se = FALSE)
dev.off()
filename <- paste0("./analysis/cache/0_zero_proportions.tif")
tiff(file=filename, width=8, height=5, units="in", res=600)
ggplot(data = whichmodel_10, aes(x= target_mean, y=zero_prop)) +
geom_jitter(width=0.05, height=0.05) +
theme_light() +
geom_smooth(method="glm", method.args=list(family="poisson")) +
labs(title = "Zero Proportions", x = "Gene Mean", y = "Zero Proportion") +
ggeasy::easy_center_title()
dev.off()
